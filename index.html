<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI Tycoon Pro</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');
        body { background: #05070a; color: white; font-family: sans-serif; margin: 0; display: flex; flex-direction: column; align-items: center; height: 100vh; overflow: hidden; user-select: none; }
        #header { width: 90%; display: flex; justify-content: space-between; padding: 15px 0; border-bottom: 1px solid #1a2236; }
        .stat-item { text-align: center; background: #0f172a; padding: 5px 10px; border-radius: 10px; border: 1px solid #7000ff; flex: 1; margin: 0 5px; }
        .stat-val { font-family: 'Orbitron', sans-serif; font-size: 11px; color: #00f2ff; }
        #score { font-family: 'Orbitron', sans-serif; font-size: 40px; font-weight: bold; text-shadow: 0 0 20px #00f2ff; margin-top: 20px; }
        #ai-hub { font-size: 100px; margin-top: 30px; cursor: pointer; transition: transform 0.1s; }
        #ai-hub:active { transform: scale(0.9); }
        
        .modal { position: fixed; bottom: 70px; width: 100%; background: #0f172a; border-radius: 20px 20px 0 0; border-top: 2px solid #7000ff; padding: 20px 0; display: none; z-index: 100; max-height: 60vh; overflow-y: auto; }
        .card { background: #1e293b; margin: 10px 20px; padding: 15px; border-radius: 12px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #334155; }
        .btn { background: #7000ff; color: white; border: none; padding: 10px; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .btn-done { background: #1abd44; }
        
        #nav { position: fixed; bottom: 0; width: 100%; display: flex; background: #05070a; border-top: 1px solid #1a2236; padding: 15px 0; }
        .nav-item { flex: 1; text-align: center; font-size: 10px; color: #64748b; cursor: pointer; }
        .active { color: #00f2ff; font-weight: bold; }
    </style>
</head>
<body>

    <div id="header">
        <div class="stat-item"><span class="stat-val" id="tap-val">+1</span></div>
        <div class="stat-item"><span class="stat-val" id="pps-val">0/s</span></div>
    </div>

    <div id="score">0</div>
    <div style="font-size: 10px; color: #5c6b89;">TOPLANAN VERÄ° (MB)</div>

    <div id="ai-hub" onclick="handleTap(event)">ğŸš€</div>

    <div id="tasks-modal" class="modal">
        <h3 style="text-align: center; margin-top: 0;">VERÄ° MADENCÄ°LÄ°ÄÄ°</h3>
        <div class="card">
            <div><b>Telegram KanalÄ±</b><br><small>+50.000 MB</small></div>
            <button id="task1-btn" class="btn" onclick="doTask('task1', 'https://t.me/KANAL_LINKIN', 50000)">KATIL</button>
        </div>
        <div class="card">
            <div><b>X (Twitter) Takip</b><br><small>+30.000 MB</small></div>
            <button id="task2-btn" class="btn" onclick="doTask('task2', 'https://x.com/HESAP_LINKIN', 30000)">TAKÄ°P ET</button>
        </div>
        <button onclick="toggleModal('', false)" style="width: 90%; margin: 10px 5%; background: #334155; border: none; color: white; padding: 10px; border-radius: 8px;">KAPAT</button>
    </div>

    <div id="shop-modal" class="modal">
        <h3 style="text-align: center; margin-top: 0;">MARKET</h3>
        <div class="card">
            <div><b>GPU V1</b><br><small>+5/sn (5000 MB)</small></div>
            <button class="btn" onclick="buy('passive', 5000, 5)">AL</button>
        </div>
        <button onclick="toggleModal('', false)" style="width: 90%; margin: 10px 5%; background: #334155; border: none; color: white; padding: 10px; border-radius: 8px;">KAPAT</button>
    </div>

    <div id="friends-modal" class="modal">
        <h3 style="text-align: center; margin-top: 0;">EKÄ°BÄ°NÄ° KUR</h3>
        <div class="card"><div id="ref-link" style="font-size: 10px;">YÃ¼kleniyor...</div><button class="btn" onclick="copyRef()">KOPYALA</button></div>
        <button onclick="toggleModal('', false)" style="width: 90%; margin: 10px 5%; background: #334155; border: none; color: white; padding: 10px; border-radius: 8px;">KAPAT</button>
    </div>

    <div id="nav">
        <div class="nav-item" onclick="toggleModal('shop-modal', true)">ğŸ›  MARKET</div>
        <div class="nav-item" onclick="toggleModal('tasks-modal', true)">ğŸ GÃ–REVLER</div>
        <div class="nav-item active" onclick="toggleModal('', false)">ğŸ’» ANA</div>
        <div class="nav-item" onclick="toggleModal('friends-modal', true)">ğŸ‘¥ EKÄ°P</div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();
        let user = tg.initDataUnsafe.user;

        let score = parseFloat(localStorage.getItem('ty_v3_score')) || 0;
        let tapPower = parseInt(localStorage.getItem('ty_v3_tap')) || 1;
        let passive = parseInt(localStorage.getItem('ty_v3_pas')) || 0;

        function updateUI() {
            document.getElementById('score').innerText = Math.floor(score).toLocaleString();
            document.getElementById('tap-val').innerText = "+" + tapPower;
            document.getElementById('pps-val').innerText = passive + "/s";
            document.getElementById('ref-link').innerText = "t.me/BOT_KULLANICI_ADI?start=" + (user ? user.id : "boss");
            
            // Tamamlanan gÃ¶revleri kontrol et
            if(localStorage.getItem('task1')) { document.getElementById('task1-btn').innerText = "ALINDI"; document.getElementById('task1-btn').className = "btn btn-done"; }
            if(localStorage.getItem('task2')) { document.getElementById('task2-btn').innerText = "ALINDI"; document.getElementById('task2-btn').className = "btn btn-done"; }
        }

        function handleTap(e) {
            score += tapPower;
            tg.HapticFeedback.impactOccurred('light');
            updateUI();
            save();
        }

        function doTask(taskId, link, reward) {
            if (localStorage.getItem(taskId)) return;
            tg.openLink(link);
            setTimeout(() => {
                score += reward;
                localStorage.setItem(taskId, 'true');
                updateUI();
                save();
                tg.showAlert("Ã–dÃ¼l HesabÄ±na TanÄ±mlandÄ±: " + reward + " MB!");
            }, 3000);
        }

        function toggleModal(id, show) {
            document.querySelectorAll('.modal').forEach(m => m.style.display = 'none');
            if (show) document.getElementById(id).style.display = 'block';
        }

        function buy(type, cost, amount) {
            if (score >= cost) {
                score -= cost;
                if (type === 'passive') passive += amount;
                updateUI(); save();
                tg.showAlert("BaÅŸarÄ±lÄ±!");
            } else { tg.showAlert("Yetersiz Veri!"); }
        }

        function copyRef() {
            let link = "https://" + document.getElementById('ref-link').innerText;
            const el = document.createElement('textarea'); el.value = link;
            document.body.appendChild(el); el.select(); document.execCommand('copy');
            document.body.removeChild(el); tg.showAlert("KopyalandÄ±!");
        }

        function save() {
            localStorage.setItem('ty_v3_score', score);
            localStorage.setItem('ty_v3_tap', tapPower);
            localStorage.setItem('ty_v3_pas', passive);
        }

        setInterval(() => { score += (passive / 10); updateUI(); }, 100);
        updateUI();
    </script>
</body>
</html>
