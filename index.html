<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI Tycoon Pro</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');
        body { background: #05070a; color: white; font-family: sans-serif; margin: 0; display: flex; flex-direction: column; align-items: center; height: 100vh; overflow: hidden; user-select: none; }
        #header { width: 90%; display: flex; justify-content: space-between; padding: 15px 0; border-bottom: 1px solid #1a2236; }
        .stat-item { text-align: center; background: #0f172a; padding: 5px 10px; border-radius: 10px; border: 1px solid #7000ff; flex: 1; margin: 0 5px; }
        .stat-val { font-family: 'Orbitron', sans-serif; font-size: 11px; color: #00f2ff; }
        #score { font-family: 'Orbitron', sans-serif; font-size: 40px; font-weight: bold; text-shadow: 0 0 20px #00f2ff; margin-top: 20px; }
        #ai-hub { font-size: 100px; margin-top: 30px; cursor: pointer; transition: transform 0.1s; }
        #ai-hub:active { transform: scale(0.9); }
        .modal { position: fixed; bottom: 70px; width: 100%; background: #0f172a; border-radius: 20px 20px 0 0; border-top: 2px solid #7000ff; padding: 20px 0; display: none; z-index: 100; }
        .card { background: #1e293b; margin: 10px 20px; padding: 15px; border-radius: 12px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #334155; }
        .btn { background: #7000ff; color: white; border: none; padding: 10px; border-radius: 8px; font-weight: bold; cursor: pointer; }
        #nav { position: fixed; bottom: 0; width: 100%; display: flex; background: #05070a; border-top: 1px solid #1a2236; padding: 15px 0; }
        .nav-item { flex: 1; text-align: center; font-size: 11px; color: #64748b; cursor: pointer; }
        .active { color: #00f2ff; }
    </style>
</head>
<body>

    <div id="header">
        <div class="stat-item"><span class="stat-val" id="tap-val">+1</span></div>
        <div class="stat-item"><span class="stat-val" id="pps-val">0/s</span></div>
    </div>

    <div id="score">0</div>
    <div style="font-size: 10px; color: #5c6b89;">TOPLANAN VERÄ° (MB)</div>

    <div id="ai-hub" onclick="handleTap(event)">ðŸš€</div>

    <div id="friends-modal" class="modal">
        <h3 style="text-align: center; margin-top: 0;">DAVET ET & KAZAN</h3>
        <p style="text-align: center; font-size: 12px; padding: 0 20px; color: #8b949e;">ArkadaÅŸÄ±nÄ± davet et, ikiniz de 100.000 MB kazanÄ±n!</p>
        <div class="card">
            <div style="font-size: 11px; color: #00f2ff;" id="ref-link">YÃ¼kleniyor...</div>
            <button class="btn" onclick="copyRef()">KOPYALA</button>
        </div>
        <button onclick="toggleModal('friends-modal', false)" style="width: 90%; margin: 10px 5%; background: #334155; border: none; color: white; padding: 10px; border-radius: 8px;">KAPAT</button>
    </div>

    <div id="shop-modal" class="modal">
        <h3 style="text-align: center; margin-top: 0;">TEKNOLOJÄ° MARKETÄ°</h3>
        <div class="card">
            <div><b>GPU V1</b><br><small>+5 Pasif/sn (5000 MB)</small></div>
            <button class="btn" onclick="buy('passive', 5000, 5)">SATIN AL</button>
        </div>
        <button onclick="toggleModal('shop-modal', false)" style="width: 90%; margin: 10px 5%; background: #334155; border: none; color: white; padding: 10px; border-radius: 8px;">KAPAT</button>
    </div>

    <div id="nav">
        <div class="nav-item active" onclick="toggleModal('', false)">ðŸ’» ANA</div>
        <div class="nav-item" onclick="toggleModal('shop-modal', true)">ðŸ›  MARKET</div>
        <div class="nav-item" onclick="toggleModal('friends-panel', true)">ðŸ‘¥ EKÄ°P</div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();
        let user = tg.initDataUnsafe.user;

        // URL'den bonusu kontrol et
        const urlParams = new URLSearchParams(window.location.search);
        let bonus = parseInt(urlParams.get('bonus')) || 0;

        let score = parseFloat(localStorage.getItem('ty_v2_score')) || 0;
        if (bonus > 0 && !localStorage.getItem('bonus_claimed')) {
            score += bonus;
            localStorage.setItem('bonus_claimed', 'true');
            tg.showAlert("HoÅŸ geldin hediyesi: 100.000 MB tanÄ±mlandÄ±!");
        }

        let tapPower = parseInt(localStorage.getItem('ty_v2_tap')) || 1;
        let passive = parseInt(localStorage.getItem('ty_v2_pas')) || 0;

        function updateUI() {
            document.getElementById('score').innerText = Math.floor(score).toLocaleString();
            document.getElementById('tap-val').innerText = "+" + tapPower;
            document.getElementById('pps-val').innerText = passive + "/s";
            document.getElementById('ref-link').innerText = "t.me/BOT_ADIN?start=" + (user ? user.id : "boss");
        }

        function handleTap(e) {
            score += tapPower;
            tg.HapticFeedback.impactOccurred('light');
            updateUI();
            save();
        }

        function toggleModal(id, show) {
            document.querySelectorAll('.modal').forEach(m => m.style.display = 'none');
            if (show) document.getElementById(id).style.display = 'block';
        }

        function buy(type, cost, amount) {
            if (score >= cost) {
                score -= cost;
                if (type === 'passive') passive += amount;
                updateUI(); save();
                tg.showAlert("Ä°ÅŸlem BaÅŸarÄ±lÄ±!");
            } else { tg.showAlert("Yetersiz Veri!"); }
        }

        function copyRef() {
            let link = document.getElementById('ref-link').innerText;
            const el = document.createElement('textarea');
            el.value = "https://" + link;
            document.body.appendChild(el); el.select(); document.execCommand('copy');
            document.body.removeChild(el);
            tg.showAlert("Davet linkin kopyalandÄ±!");
        }

        function save() {
            localStorage.setItem('ty_v2_score', score);
            localStorage.setItem('ty_v2_tap', tapPower);
            localStorage.setItem('ty_v2_pas', passive);
        }

        setInterval(() => { score += (passive / 10); updateUI(); }, 100);
        updateUI();
    </script>
</body>
</html>
