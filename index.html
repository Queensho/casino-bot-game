<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI Tycoon | MacBook 5001</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');
        body { background: #05070a; color: white; font-family: sans-serif; margin: 0; display: flex; flex-direction: column; align-items: center; height: 100vh; overflow: hidden; }
        #score-display { font-family: 'Orbitron'; font-size: 45px; font-weight: bold; margin: 50px 0; text-shadow: 0 0 20px #00f2ff; }
        #brain-btn { width: 180px; height: 180px; border-radius: 50%; background: radial-gradient(circle, #1a103d, #05070a); border: 3px solid #7000ff; font-size: 80px; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 0 30px rgba(112, 0, 255, 0.4); }
        #status-label { position: fixed; bottom: 90px; font-size: 10px; color: #4b5563; }
        .nav { position: fixed; bottom: 0; width: 100%; display: flex; background: #0d1117; padding: 15px 0; border-top: 1px solid #1a2236; }
        .nav-item { flex: 1; text-align: center; color: #4b5563; font-weight: bold; font-size: 12px; }
    </style>
</head>
<body>

    <div id="score-display">0</div>
    <div style="margin-top:-45px; color:#00f2ff; font-family:Orbitron; font-size:12px;">MB DATA SAVED</div>

    <div id="brain-btn" onclick="handleTap()">üß†</div>

    <div id="status-label">Bulut baƒülantƒ±sƒ± bekleniyor...</div>

    <div class="nav">
        <div class="nav-item" style="color:#00f2ff;">ANA EKRAN</div>
        <div class="nav-item" onclick="tg.showAlert('Liderlik Tablosu Veritabanƒ±ndan √áekilecek!')">SIRALAMA</div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();
        
        // --- ngrok'tan aldƒ±ƒüƒ±n https://... linkini buraya yapƒ±≈ütƒ±r ---
        const SERVER_URL = "BURAYA_NGROK_LINKINI_YAPISTIR"; 
        
        let user = tg.initDataUnsafe.user || { id: "000", first_name: "Boss" };
        let score = 0;

        async function login() {
            try {
                const res = await fetch(`${SERVER_URL}/login`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ user_id: user.id, username: user.first_name })
                });
                const data = await res.json();
                score = data.score;
                document.getElementById('score-display').innerText = Math.floor(score).toLocaleString();
                document.getElementById('status-label').innerText = "‚úÖ MacBook Cloud Baƒülandƒ±";
            } catch (e) {
                document.getElementById('status-label').innerText = "‚ùå Sunucu Baƒülantƒ± Hatasƒ±";
            }
        }

        function handleTap() {
            score += 1;
            document.getElementById('score-display').innerText = Math.floor(score).toLocaleString();
            tg.HapticFeedback.impactOccurred('medium');
        }

        async function sync() {
            try {
                await fetch(`${SERVER_URL}/save`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ user_id: user.id, score: score })
                });
                document.getElementById('status-label').innerText = "‚úÖ MacBook'a Kaydedildi: " + new Date().toLocaleTimeString();
            } catch (e) {}
        }

        login();
        setInterval(sync, 15000); // 15 saniyede bir otomatik yedekle
    </script>
</body>
</html>
